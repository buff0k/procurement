[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Request for Quotation",
  "enabled": 1,
  "modified": "2025-06-11 16:03:13.971674",
  "module": "Procurement",
  "name": "Auto Populate ESD Suppliers",
  "script": "frappe.ui.form.on('Request for Quotation', {\r\n    custom_local_community_procurement: function(frm) {\r\n        // Check if a Local Suppliers document is selected\r\n        if (frm.doc.custom_local_community_procurement) {\r\n            // Fetch the selected Local Suppliers document\r\n            frappe.call({\r\n                method: 'frappe.client.get',\r\n                args: {\r\n                    doctype: 'Local Suppliers',\r\n                    name: frm.doc.custom_local_community_procurement\r\n                },\r\n                callback: function(response) {\r\n                    if (response.message) {\r\n                        let localSuppliersDoc = response.message;\r\n\r\n                        // Clear existing suppliers table\r\n                        frm.clear_table('suppliers');\r\n\r\n                        // Populate suppliers child table with esd_suppliers data\r\n                        if (localSuppliersDoc.esd_suppliers) {\r\n                            localSuppliersDoc.esd_suppliers.forEach(function(supplier) {\r\n                                let newRow = frm.add_child('suppliers');\r\n                                newRow.supplier = supplier.supplier_name; // Map supplier_name to supplier\r\n                                newRow.contact = supplier.contact;        // Map contact\r\n                                newRow.email_id = supplier.email_id;      // Map email_id\r\n                                newRow.mobile_no = supplier.mobile_no;    // Map mobile_no\r\n                            });\r\n\r\n                            // Refresh the suppliers child table to show updated values\r\n                            frm.refresh_field('suppliers');\r\n                        }\r\n                    } else {\r\n                        console.warn(\"No Local Suppliers document found for:\", frm.doc.custom_local_community_procurement);\r\n                    }\r\n                },\r\n                error: function(err) {\r\n                    console.error(\"Error fetching Local Suppliers document:\", err);\r\n                }\r\n            });\r\n        } else {\r\n            // Clear suppliers table if no Local Suppliers document is selected\r\n            frm.clear_table('suppliers');\r\n            frm.refresh_field('suppliers');\r\n        }\r\n    }\r\n});",
  "view": "Form"
 }
]